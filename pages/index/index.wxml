<view class="page">
  <!-- é¡¶éƒ¨ -->
  <view class="hero">
    <view class="brand">
      <view class="title">æš–é£Ÿè®°</view>
      <view class="subtitle">åœ¨æ‰‹æœºä¸Šæ‰¾åˆ°ä»Šå¤©çš„çµæ„Ÿ</view>
    </view>
    <view class="search-bar">
      <text class="icon">ğŸ”</text>
      <input class="search-input" placeholder="æœç´¢èœåæˆ–å£å‘³" bindinput="onSearchInput" value="{{searchQuery}}" confirm-type="search" />
    </view>
  </view>

  <!-- åˆ†ç±» -->
  <scroll-view class="cat-bar" scroll-x>
    <view class="cat-row">
      <view
        wx:for="{{categories}}"
        wx:key="*this"
        class="cat-chip {{selectedCategory===item ? 'active' : ''}}"
        data-cat="{{item}}"
        bindtap="selectCategory"
      >
        {{item}}
      </view>
    </view>
  </scroll-view>

  <!-- èœè°±åˆ—è¡¨ -->
  <scroll-view class="list" scroll-y>
    <view class="waterfall">
      <view class="column">
        <view
          wx:for="{{leftColumnRecipes}}"
          wx:key="id"
          class="recipe-card"
          data-id="{{item.id}}"
          bindtap="openRecipe"
        >
          <image
            class="cover"
            src="{{item.image}}"
            mode="aspectFill"
            style="height: {{item.cardHeight}}rpx;"
          />
          <view class="card-body">
            <view class="card-title">{{item.title}}</view>
            <view class="card-meta">
              <text>{{item.time}}</text>
              <text>â¤ï¸ {{item.likes}}</text>
            </view>
            <view class="tag-row">
              <view class="tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</view>
            </view>
            <view class="desc">{{item.description}}</view>
          </view>
        </view>
      </view>

      <view class="column">
        <view
          wx:for="{{rightColumnRecipes}}"
          wx:key="id"
          class="recipe-card"
          data-id="{{item.id}}"
          bindtap="openRecipe"
        >
          <image
            class="cover"
            src="{{item.image}}"
            mode="aspectFill"
            style="height: {{item.cardHeight}}rpx;"
          />
          <view class="card-body">
            <view class="card-title">{{item.title}}</view>
            <view class="card-meta">
              <text>{{item.time}}</text>
              <text>â¤ï¸ {{item.likes}}</text>
            </view>
            <view class="tag-row">
              <view class="tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</view>
            </view>
            <view class="desc">{{item.description}}</view>
          </view>
        </view>
      </view>
    </view>

    <view wx:if="{{filteredRecipes.length===0}}" class="empty">
      æš‚æ— åŒ¹é…èœè°±ï¼Œæ¢ä¸ªå…³é”®è¯è¯•è¯•ï½
    </view>
  </scroll-view>

  <!-- å¼¹å±‚ï¼šèœè°±è¯¦æƒ…ä¸æµæ°´çº¿æ­¥éª¤ -->
  <view wx:if="{{showModal}}" class="modal">
    <view class="mask" catchtouchmove="noop" bindtap="closeModal"></view>
    <view
      class="modal-panel"
      catchtouchmove="noop"
      bindtouchstart="onModalTouchStart"
      bindtouchend="onModalTouchEnd"
    >
      <view class="pull-hint"></view>
      <view class="modal-header">
        <view>
          <view class="modal-title">{{activeRecipe.title}}</view>
          <view class="modal-meta">{{activeRecipe.time}} Â· â¤ï¸ {{activeRecipe.likes}}</view>
        </view>
        <button class="cook-btn" size="mini" bindtap="startCook">å¼€åšï¼</button>
      </view>

      <scroll-view class="modal-scroll" scroll-y>
        <view class="section">
          <view class="section-title">ç”¨æ–™</view>
          <view class="pill-row">
            <view class="pill" wx:for="{{activeRecipe.ingredients}}" wx:key="*this">{{item}}</view>
          </view>
        </view>

        <view class="section">
          <view class="section-title">çƒ¹é¥ªæ­¥éª¤ï¼ˆ{{activeStepIndex + 1}} / {{activeRecipe.steps.length}}ï¼‰</view>
          <swiper
            class="step-swiper"
            current="{{activeStepIndex}}"
            bindchange="onStepChange"
            previous-margin="32rpx"
            next-margin="32rpx"
          >
            <swiper-item wx:for="{{activeRecipe.steps}}" wx:key="index">
              <view class="step-card">
                <view class="step-index">æ­¥éª¤ {{index + 1}}</view>
                <view class="step-text">{{item}}</view>
              </view>
            </swiper-item>
          </swiper>
          <view class="step-actions">
            <button class="ghost" size="mini" bindtap="goPrevStep" disabled="{{activeStepIndex===0}}">ä¸Šä¸€æ­¥</button>
            <button class="primary" size="mini" bindtap="goNextStep" disabled="{{activeRecipe.steps.length-1===activeStepIndex}}">ä¸‹ä¸€æ­¥</button>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>
</view>
